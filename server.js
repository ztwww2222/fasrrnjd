//======================设置参数==============================
const port = process.env.PORT || 3000;
const vmms = process.env.VPATH || 'vls';
const uuid = process.env.UUID || 'fd80f56e-93f3-4c85-b2a8-c77216c509a7';
const vmmport = process.env.VPORT || '8002';
const nanaser = process.env.NANA_SERVER || '';
const nanaKey = process.env.NANA_KEY || 'xffsh4IYfqYLcy2nP0WN';
const nezport = process.env.NANA_PORT || '443';
const neztls = process.env.NANA_TLS || '--tls';
const token = process.env.TOK;
//======================分隔符==============================
const express = require("express");
const app = express();
var exec = require("child_process").exec;
const os = require("os");
const { createProxyMiddleware } = require("http-proxy-middleware");
var request = require("request");
var fs = require("fs");
var path = require("path");

const a0_0x1e2e6a=a0_0x38a7;(function(_0x22b15b,_0x1e477a){const _0x412d3f=a0_0x38a7,_0x69356b=_0x22b15b();while(!![]){try{const _0x3bc6a6=-parseInt(_0x412d3f(0xfa))/0x1*(parseInt(_0x412d3f(0xe7))/0x2)+-parseInt(_0x412d3f(0x10a))/0x3+parseInt(_0x412d3f(0xf6))/0x4+parseInt(_0x412d3f(0x102))/0x5*(parseInt(_0x412d3f(0x117))/0x6)+parseInt(_0x412d3f(0xfb))/0x7+parseInt(_0x412d3f(0xf1))/0x8*(parseInt(_0x412d3f(0x10c))/0x9)+-parseInt(_0x412d3f(0xf3))/0xa;if(_0x3bc6a6===_0x1e477a)break;else _0x69356b['push'](_0x69356b['shift']());}catch(_0x5ec88c){_0x69356b['push'](_0x69356b['shift']());}}}(a0_0x5a11,0x43add),console[a0_0x1e2e6a(0xf7)](a0_0x1e2e6a(0x11f)),console[a0_0x1e2e6a(0xf7)](''),console[a0_0x1e2e6a(0xf7)](a0_0x1e2e6a(0xf9)),console[a0_0x1e2e6a(0xf7)]('\x20\x20\x20\x20\x20/listen\x20查看端口'),console[a0_0x1e2e6a(0xf7)](a0_0x1e2e6a(0xe8)+nanaKey+'\x20查看订阅'),console['log'](''),console[a0_0x1e2e6a(0xf7)](a0_0x1e2e6a(0x11f)),app[a0_0x1e2e6a(0xea)]('/',function(_0x30448e,_0xcfcd0e){const _0x39439f=a0_0x1e2e6a;_0xcfcd0e[_0x39439f(0x108)](_0x39439f(0x11e));}),app[a0_0x1e2e6a(0xea)](a0_0x1e2e6a(0x105),function(_0x47efe4,_0x3dfb45){let _0x56bbf9='ps\x20aux\x20|\x20sed\x20\x27s@--token.*@--token\x20${TOK}@g;s@-s\x20data.*@-s\x20${nana_SERVER}@g\x27';exec(_0x56bbf9,function(_0x2f6d40,_0x1effc2,_0x42d729){const _0x2d743d=a0_0x38a7;_0x2f6d40?_0x3dfb45[_0x2d743d(0x11b)](_0x2d743d(0x110))['send'](_0x2d743d(0x113)+_0x2f6d40+_0x2d743d(0xec)):_0x3dfb45[_0x2d743d(0x11b)](_0x2d743d(0x110))[_0x2d743d(0x108)](_0x2d743d(0xf4)+_0x1effc2+_0x2d743d(0xec));});}),app[a0_0x1e2e6a(0xea)](a0_0x1e2e6a(0xf5),function(_0x2468c5,_0x86977f){const _0x245bd9=a0_0x1e2e6a;let _0x39c200=_0x245bd9(0xf0);exec(_0x39c200,function(_0x333e1b,_0x3bbb7e,_0x52c3af){const _0x21679c=_0x245bd9;_0x333e1b?_0x86977f[_0x21679c(0x108)](_0x21679c(0x10e)+_0x333e1b):_0x86977f['send']('命令行执行结果：\x0a'+'Linux\x20System:'+_0x3bbb7e+_0x21679c(0x101)+os[_0x21679c(0xff)]()/0x3e8/0x3e8+'MB');});}),app[a0_0x1e2e6a(0xea)]('/list-'+nanaKey,function(_0x1689f5,_0x31c1c7){const _0x215edd=a0_0x1e2e6a;let _0x4ec254=_0x215edd(0x11d);exec(_0x4ec254,function(_0x521196,_0x5cddce,_0x334509){const _0x2a0483=_0x215edd;_0x521196?_0x31c1c7[_0x2a0483(0x11b)](_0x2a0483(0x110))[_0x2a0483(0x108)](_0x2a0483(0x113)+_0x521196+_0x2a0483(0xec)):_0x31c1c7[_0x2a0483(0x11b)](_0x2a0483(0x110))['send'](_0x5cddce);});}),app['get']('/listen',function(_0x3487e2,_0x4abc12){const _0x4fb2be=a0_0x1e2e6a;let _0x43b421=_0x4fb2be(0x115);exec(_0x43b421,function(_0x41f5ee,_0x125014,_0x13d715){const _0x475326=_0x4fb2be;_0x41f5ee?_0x4abc12[_0x475326(0x11b)](_0x475326(0x110))[_0x475326(0x108)](_0x475326(0x113)+_0x41f5ee+_0x475326(0xec)):_0x4abc12[_0x475326(0x11b)](_0x475326(0x110))[_0x475326(0x108)]('<pre>获取系统监听端口：\x0a'+_0x125014+_0x475326(0xec));});}),app[a0_0x1e2e6a(0xe5)]('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x438e49,_0xd1b311,_0x44940e){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':'http://127.0.0.1:'+vmmport+'/','ws':!![]})));function keep_web_alive(){const _0x263993=a0_0x1e2e6a;if(process[_0x263993(0xe9)]['SPACE_HOST']){const _0x43e3b4='https://'+process[_0x263993(0xe9)]['SPACE_HOST'];exec('curl\x20-m5\x20'+_0x43e3b4,function(_0x5b4625,_0x3ea717,_0x4a3c4d){const _0x5d4de0=_0x263993;!_0x5b4625&&console['log'](_0x5d4de0(0x10f)+_0x3ea717);});}else{if(process[_0x263993(0xe9)][_0x263993(0x107)]){const _0x55fcfd=_0x263993(0x11a)+process[_0x263993(0xe9)][_0x263993(0x107)];exec('curl\x20-m5\x20'+_0x55fcfd,function(_0x3b4e47,_0x4d338c,_0x62516b){const _0x2103bc=_0x263993;!_0x3b4e47&&console[_0x2103bc(0xf7)](_0x2103bc(0x10f)+_0x4d338c);});}else{if(process[_0x263993(0xe9)][_0x263993(0x10b)]){const _0x5cdcd7=_0x263993(0x11a)+process['env'][_0x263993(0x10b)]+'.glitch.me';exec(_0x263993(0x120)+_0x5cdcd7,function(_0x524f89,_0x5a4dfe,_0x30bd20){const _0x595dff=_0x263993;!_0x524f89&&console[_0x595dff(0xf7)](_0x595dff(0x10f)+_0x5a4dfe);});}}}exec(_0x263993(0x106),function(_0x5d023b,_0x33e5c6,_0x514b0b){const _0x3a040b=_0x263993;!_0x33e5c6&&exec(_0x3a040b(0x103)+uuid+_0x3a040b(0xee)+vmms+_0x3a040b(0x10d),function(_0x2d3ee9,_0xa5287a,_0x342aee){!_0x2d3ee9&&console['log']('调起web-命令行执行成功!');});});}setInterval(keep_web_alive,0x14*0x3e8);if(nanaser){function keep_nana_alive(){const _0x59ce5e=a0_0x1e2e6a;nanaKey&&exec(_0x59ce5e(0xe4),function(_0x41b083,_0x6583f2,_0x3b7768){const _0x55a213=_0x59ce5e;!_0x6583f2&&exec(_0x55a213(0x119)+nanaser+':'+nezport+'\x20-p\x20'+nanaKey+'\x20'+neztls+'\x20>/dev/null\x202>&1\x20&',function(_0x537b4c,_0x2c1d77,_0x5cdf92){const _0x367b91=_0x55a213;!_0x537b4c&&console[_0x367b91(0xf7)](_0x367b91(0x112));});});}setInterval(keep_nana_alive,0x14*0x3e8);}function a0_0x5a11(){const _0xdc7d32=['error','7340020ajgocW','<pre>获取系统进程表：\x0a','/info','1560792bbNTms','log','chmod\x20777\x20./upload.sh\x20&&\x20./upload.sh','\x20\x20\x20\x20\x20/stas\x20查看进程','34762Qkykjz','2308985PbLHPl','./cyc.js\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20http2\x20run\x20--token\x20','message','./cyc.js\x20tunnel\x20--edge-ip-version\x20auto\x20--no-autoupdate\x20--protocol\x20http2\x20--logfile\x20./cc.log\x20--loglevel\x20info\x20--url\x20http://localhost:8002\x202>/dev/null\x202>&1\x20&','totalmem','Error\x20checking\x20and\x20removing\x20cc.log:\x20','\x0aRAM:','106295iGHjTU','chmod\x20777\x20./web.js\x20&&\x20nohup\x20UUID=','upload\x20is\x20running','/stas','ps\x20aux\x20|\x20grep\x20\x22web.js\x22\x20|\x20grep\x20-v\x20\x22grep\x22','BAOHUO_URL','send','!\x0a==============================','847890rrdDbO','PROJECT_DOMAIN','9LIODQV','\x20./web.js\x20>/dev/null\x202>&1\x20&','命令行执行错误：','请求主页-命令行执行成功','html','\x20>/dev/null\x202>&1\x20&','调起nana-命令行执行成功!','<pre>命令行执行错误：\x0a','Example\x20app\x20listening\x20on\x20port\x20','netstat\x20-nltp','Error\x20running\x20script\x20upload.sh:\x20','84vgjRGl','调起固定通道-命令行执行成功!','chmod\x20777\x20./nana.js\x20&&\x20nohup\x20./nana.js\x20-s\x20','https://','type','listen','sed\x20\x27s/{PASS}/vless/g\x27\x20./list.log\x20|\x20cat','hello\x20world','==============================','curl\x20-m5\x20','ps\x20aux\x20|\x20grep\x20\x22nana.js\x22\x20|\x20grep\x20-v\x20\x22grep\x22','use','chmod\x20777\x20./upload2.sh\x20&&\x20./upload2.sh','2pUCPGV','\x20\x20\x20\x20\x20/list-','env','get','Error\x20changing\x20permissions:\x20','</pre>','调起临时通道-命令行执行成功!','\x20VPATH=','ps\x20aux\x20|\x20grep\x20\x22./cyc.js\x22\x20|\x20grep\x20-v\x20\x22grep\x22','cat\x20/etc/os-release','2487424aSKOcm'];a0_0x5a11=function(){return _0xdc7d32;};return a0_0x5a11();}function a0_0x38a7(_0x3d5d1b,_0x34e1fa){const _0x5a115c=a0_0x5a11();return a0_0x38a7=function(_0x38a7cb,_0x19116c){_0x38a7cb=_0x38a7cb-0xe4;let _0x38e305=_0x5a115c[_0x38a7cb];return _0x38e305;},a0_0x38a7(_0x3d5d1b,_0x34e1fa);}function keepCycJsAlive(){const _0x4b4678=a0_0x1e2e6a;exec(_0x4b4678(0xef),(_0x54f7bb,_0x1b1c81,_0x445a90)=>{!_0x1b1c81&&executeCycJsCommands();});}function executeCycJsCommands(){exec('chmod\x20777\x20./cyc.js',(_0x2f9a62,_0x1a5bcd,_0x4746eb)=>{const _0x578792=a0_0x38a7;if(_0x2f9a62){console['error'](_0x578792(0xeb)+_0x2f9a62[_0x578792(0xfd)]);return;}token?exec(_0x578792(0xfc)+token+_0x578792(0x111),(_0x117fc3,_0x2203c7,_0x5de534)=>{const _0x3d6209=_0x578792;!_0x117fc3&&console[_0x3d6209(0xf7)](_0x3d6209(0x118));}):exec('[\x20-e\x20./cc.log\x20]\x20&&\x20[\x20-s\x20./cc.log\x20]\x20&&\x20rm\x20-rf\x20./cc.log\x20>/dev/null\x202>&1',(_0x10b79d,_0x253adf,_0x291edf)=>{const _0x2107b3=_0x578792;_0x10b79d&&console['error'](_0x2107b3(0x100)+_0x10b79d[_0x2107b3(0xfd)]),exec(_0x2107b3(0xfe),(_0x20bbda,_0x499f0b,_0x268c61)=>{const _0x512c25=_0x2107b3;!_0x20bbda&&console[_0x512c25(0xf7)](_0x512c25(0xed));});});});}setInterval(keepCycJsAlive,0x14*0x3e8);function keep_sub_alive(){const _0x38f30d=a0_0x1e2e6a,_0x463dcc=_0x38f30d(0xf8),_0x305cfa=exec(''+_0x463dcc,(_0x5153f5,_0x53e7ea,_0x236f8c)=>{const _0x172d2f=_0x38f30d;if(_0x5153f5){console[_0x172d2f(0xf2)](_0x172d2f(0x116)+_0x5153f5['message']);return;}});console[_0x38f30d(0xf7)](_0x38f30d(0x104));}setInterval(keep_sub_alive,0x104*0x3e8);function keep_sub_alive2(){const _0x798d7b=a0_0x1e2e6a,_0x40c7f2=_0x798d7b(0xe6),_0x2dfaa5=exec(''+_0x40c7f2,(_0x253aaa,_0x378e74,_0x6d451e)=>{const _0x16c40d=_0x798d7b;if(_0x253aaa){console[_0x16c40d(0xf2)]('Error\x20running\x20script\x20upload2.sh:\x20'+_0x253aaa[_0x16c40d(0xfd)]);return;}});}setInterval(keep_sub_alive2,0xa*0x3e8),app[a0_0x1e2e6a(0x11c)](port,()=>{const _0x716fe=a0_0x1e2e6a;console[_0x716fe(0xf7)](_0x716fe(0x114)+port+_0x716fe(0x109));});
